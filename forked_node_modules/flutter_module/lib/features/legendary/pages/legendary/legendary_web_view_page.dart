import 'package:auto_route/auto_route.dart';
import 'package:flutter/material.dart';
import 'package:flutter_bloc/flutter_bloc.dart';
import 'package:flutter_module/app_data.dart';
import 'package:flutter_module/common/colors.dart';
import 'package:flutter_module/common/widgets/mascot/mascot_no_login_widget.dart';
import 'package:flutter_module/features/authentication/auth/auth_cubit.dart';
import 'package:flutter_module/features/webview/webview_page.dart';
import 'package:flutter_module/routes/routes.gr.dart';

class LegendaryWebViewPage extends StatefulWidget {
  const LegendaryWebViewPage({super.key});

  @override
  State<LegendaryWebViewPage> createState() => _LegendaryWebViewPageState();
}

class _LegendaryWebViewPageState extends State<LegendaryWebViewPage> {
  @override
  Widget build(BuildContext context) {
    return BlocBuilder<AuthCubit, AuthState>(
      builder: (context, authState) {
        final hasLoggedIn = authState.hasLoggedIn;
        final url = AppData.instance.appInfo.incomeTabUrl;

        ///
        if (!hasLoggedIn) {
          return Scaffold(
            backgroundColor: UIColors.background,
            body: SafeArea(
              top: false,
              child: Column(
                children: [
                  Expanded(
                    child: Align(
                      alignment: const FractionalOffset(0.5, 0.5),
                      child: MascotNoLoginWidget(
                        asset: 'ic_mascot_10_point',
                        onLogin: () {
                          context.router.push(LoginRoute());
                        },
                      ),
                    ),
                  ),
                ],
              ),
            ),
          );
        }

        return Container(
          decoration: const BoxDecoration(
            color: UIColors.background,
          ),
          child: WebViewPage(
            url: url,
            showTitle: false,
            showSafeBottom: false,
            backgroundColor: UIColors.background,
          ),
        );
      },
    );
  }
}
