import 'package:flutter/material.dart';
import 'package:flutter_bloc/flutter_bloc.dart';
import 'package:flutter_module/common/enum/statistic_working/statistic_working_level.dart';
import 'package:flutter_module/features/statistic_working/cubit/statistic_asm_report/statistic_asm_report_cubit.dart';

import '../../statistic_working/components/statistic_list_component.dart';
import '../../statistic_working/mixins/statistic_working_mixin.dart';
import '../items/statistic_report_item.dart';

class StatisticNotReportComponent extends StatelessWidget with StatisticWorkingMixin {
  const StatisticNotReportComponent({super.key, this.name});

  final String? name;

  @override
  Widget build(BuildContext context) {
    return BlocBuilder<StatisticAsmNotReportCubit, StatisticAsmReportState>(
      builder: (context, state) {
        return StatisticListComponent(
          level: StatisticWorkingLevel.agent.code,
          name: name,
          status: state.status,
          data: state.data,
          onItemBuilder: (context, item, index) {
            return StatisticReportItem(
              item: item,
              isReported: false,
              onTap: () {
                openReport(context, userID: item.userID, level: item.level);
              },
            );
          },
          onTitleDisplayed: (level, name) {
            return 'Tổng ${StatisticWorkingLevel.getUnderLevel(level)} chưa báo cáo của $name';
          },
          onRefresh: context.read<StatisticAsmNotReportCubit>().refreshData,
          onLoadMore: context.read<StatisticAsmNotReportCubit>().loadmoreData,
          onSearchChanged: context.read<StatisticAsmNotReportCubit>().onSearch,
        );
      },
    );
  }
}
