import 'package:auto_route/auto_route.dart';
import 'package:flutter/foundation.dart';
import 'package:flutter/material.dart';
import 'package:flutter_module/common/enum/log_event_key.dart';
import 'package:flutter_module/common/styles.dart';
import 'package:flutter_module/common/utils/log_event_util.dart';
import 'package:flutter_module/common/widgets/buttons.dart';
import 'package:flutter_module/features/mtrade/page/mtrade/components/delivery_support/delivery_support_widget.dart';

import '../../../../../../../app_data.dart';
import '../../../../../../../common/colors.dart';
import '../../../../../../../common/widgets/images.dart';
import '../../../../../../../routes/routes.gr.dart';
import '../../../components/filter_button.dart';

class SearchBarComponent extends StatelessWidget {
  const SearchBarComponent({
    Key? key,
    this.collapse = false,
    this.autoShowDialog = false,
  }) : super(key: key);

  final bool collapse;
  final bool autoShowDialog;

  @override
  Widget build(BuildContext context) {
    return Container(
      height: 88,
      color: UIColors.background,
      padding: const EdgeInsets.symmetric(horizontal: 16),
      child: ListView(
        physics: const NeverScrollableScrollPhysics(),
        shrinkWrap: true,
        padding: EdgeInsets.zero,
        children: [
          if (!collapse) ...[
            MTradeDeliverySupportWidget(
              autoShowDialog: !kIsWeb && autoShowDialog,
            ),
            const SizedBox(
              height: 8,
            ),
          ],
          Row(
            children: [
              Expanded(
                child: SplashButton(
                  borderRadius: BorderRadius.circular(25),
                  onTap: () {
                    LogEventUtil.send(LogEventKey.mTradeSearchTool, data: {"search": "search_product"});
                    context.pushRoute(MTradeSearchRoute(
                        // pageID: AppData.instance.landingPageID,
                        // provinceCode: AppData.instance.landingPageProvinceCode,
                        // districtCode: AppData.instance.landingPageDistrictCode,
                        ));
                  },
                  child: Container(
                    padding: const EdgeInsets.symmetric(horizontal: 12, vertical: 8),
                    decoration: BoxDecoration(
                      color: UIColors.white,
                      borderRadius: BorderRadius.circular(25),
                    ),
                    child: Row(
                      children: [
                        const AppImage.asset(
                          asset: "ic_search_outline",
                          width: 24,
                          height: 24,
                          color: UIColors.grayText,
                        ),
                        const SizedBox(
                          width: 12,
                        ),
                        Text(
                          'Tìm kiếm',
                          style: UITextStyle.regular.copyWith(
                            color: UIColors.grayText,
                          ),
                        )
                      ],
                    ),
                  ),
                ),
              ),
              if (kIsWeb)
                const SizedBox(
                  width: 12,
                ),
              if (kIsWeb)
                SplashButton(
                  borderRadius: BorderRadius.circular(20),
                  onTap: () {
                    context.router.push(MTradeSearchOrderRoute(
                      pageID: AppData.instance.landingPageID,
                      provinceCode: AppData.instance.landingPageProvinceCode,
                      districtCode: AppData.instance.landingPageDistrictCode,
                    ));
                  },
                  child: Container(
                    width: 40,
                    height: 40,
                    alignment: Alignment.center,
                    decoration: const BoxDecoration(
                      shape: BoxShape.circle,
                      color: UIColors.white,
                    ),
                    child: const AppImage.asset(
                      asset: 'ic_view_order',
                      width: 24,
                      height: 24,
                    ),
                  ),
                ),
              // const MTradeDeliverySupportButton(
              //   autoShowDialog: true,
              // ),
              if (collapse) ...[
                const SizedBox(
                  width: 12,
                ),
                MTradeDeliverySupportWidget(
                  autoShowDialog: !kIsWeb && autoShowDialog,
                  collapse: collapse,
                ),
              ],
              const SizedBox(
                width: 12,
              ),
              const MTradeFilterButton(
                fromMTradeProduct: true,
                enableClearFilter: true,
              ),
            ],
          ),
        ],
      ),
    );
  }
}
