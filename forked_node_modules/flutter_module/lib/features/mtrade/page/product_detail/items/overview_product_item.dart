import 'package:flutter/material.dart';
import 'package:flutter_bloc/flutter_bloc.dart';
import 'package:flutter_module/common/colors.dart';
import 'package:flutter_module/common/extension/list_extension.dart';
import 'package:flutter_module/common/styles.dart';
import 'package:flutter_module/common/utils/format_util.dart';
import 'package:flutter_module/common/widgets/images.dart';
import 'package:flutter_module/features/mtrade/cubit/product_detail/mtrade_product_detail_cubit.dart';

class OverviewProductItem extends StatelessWidget {
  const OverviewProductItem({Key? key}) : super(key: key);

  @override
  Widget build(BuildContext context) {
    final state = context.select((MTradeProductDetailCubit cubit) => cubit.state);
    final String image = state.product?.productImages?.valueAt(0) ?? "";
    final String name = state.product?.name ?? "";
    // final int comparePrice = state.product?.comparePrice ?? 0;
    final int price = state.skuDetail?.price ?? state.product?.price ?? 0;
    final List<List<String>> option = state.skuDetail?.options ?? [];

    ///
    return SizedBox(
      child: Row(
        crossAxisAlignment: CrossAxisAlignment.start,
        children: [
          AppImage.network(
            url: image,
            width: 87,
            height: 87,
            borderRadius: BorderRadius.circular(12),
          ),
          const SizedBox(
            width: 16,
          ),
          Expanded(
            child: Column(
              mainAxisAlignment: MainAxisAlignment.center,
              crossAxisAlignment: CrossAxisAlignment.start,
              children: [
                Text(
                  name,
                  style: UITextStyle.regular.copyWith(
                    fontSize: 14,
                  ),
                ),
                const SizedBox(
                  height: 5,
                ),
                ...List.generate(option.length, (index) {
                  final item = option[index];
                  final attribute = state.product?.attributes?.valueAt(index)?.name ?? "";
                  return RichText(
                    text: TextSpan(
                      children: [
                        TextSpan(
                          text: "$attribute:",
                          style: UITextStyle.regular.copyWith(
                            fontSize: 13,
                            color: UIColors.grayText,
                          ),
                        ),
                        const WidgetSpan(
                          child: SizedBox(
                            width: 10,
                          ),
                        ),
                        TextSpan(
                          text: item.valueAt(1) ?? "",
                          style: UITextStyle.regular.copyWith(
                            fontSize: 13,
                          ),
                        ),
                      ],
                    ),
                  );
                }),
                const SizedBox(
                  height: 5,
                ),
                Text(
                  FormatUtil.currencyFormat(price),
                  style: UITextStyle.medium.copyWith(
                    fontSize: 16,
                  ),
                ),
                // Row(
                //   children: [
                //     Text(
                //       FormatUtil.currencyFormat(price),
                //       style: UITextStyle.medium.copyWith(
                //         fontSize: 16,
                //       ),
                //     ),
                //     const Spacer(),
                //     Text(
                //       FormatUtil.currencyFormat(comparePrice),
                //       style: UITextStyle.regular.copyWith(
                //         fontSize: 14,
                //         color: UIColors.grayText,
                //         decoration: TextDecoration.lineThrough,
                //       ),
                //     ),
                //   ],
                // ),
              ],
            ),
          ),
        ],
      ),
    );
  }
}
