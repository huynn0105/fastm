import 'package:flutter/material.dart';
import 'package:flutter_module/common/bottom_sheet/bottom_sheet_provider.dart';
import 'package:flutter_module/common/colors.dart';
import 'package:flutter_module/common/styles.dart';
import 'package:flutter_module/common/widgets/buttons.dart';
import 'package:flutter_module/common/widgets/images.dart';

class ButtonFilterSelectComponent extends StatelessWidget {
  const ButtonFilterSelectComponent({
    super.key,
    this.title,
    this.data,
    this.placeholder,
    this.onTap,
    this.indexSelected = 0,
  });
  final String? title;
  final List<String>? data;
  final String? placeholder;
  final Function(int index)? onTap;
  final int indexSelected;

  @override
  Widget build(BuildContext context) {
    return SplashButton(
      onTap: () async {
        final index = await BottomSheetProvider.instance.showCupertinoPicker(
          context,
          title: pickerTitle,
          data: data ?? [],
          autoScrollToIndex: true,
          initIndex: indexSelected,
        );
        if (index is int) {
          onTap?.call(index);
        }
      },
      child: Container(
        padding: const EdgeInsets.symmetric(
          horizontal: 12,
          vertical: 8,
        ),
        decoration: BoxDecoration(
            color: UIColors.white,
            borderRadius: BorderRadius.circular(8),
            border: Border.all(
              width: 1,
              color: UIColors.lightGray,
            )),
        child: Row(
          children: [
            const AppImage.asset(
              asset: 'ic_filter',
              width: 20,
              height: 20,
            ),
            const SizedBox(
              width: 12,
            ),
            Expanded(
              child: Text(
                (title ?? placeholder ?? ''),
                style: title?.isNotEmpty == true
                    ? UITextStyle.semiBold
                    : UITextStyle.regular.copyWith(
                        fontSize: 13,
                        color: UIColors.grayText,
                      ),
                maxLines: 1,
                overflow: TextOverflow.ellipsis,
              ),
            ),
          ],
        ),
      ),
    );
  }

  String get pickerTitle => capitalize(data?[0].replaceAll('Tất cả ', '') ?? 'Vui lòng chọn');

  String capitalize(String title) {
    return "${title[0].toUpperCase()}${title.substring(1).toLowerCase()}";
  }
}
