import 'package:flutter/material.dart';
import 'package:flutter/services.dart';
import 'package:scroll_to_index/scroll_to_index.dart';

import '../../../../../../../common/constants.dart';
import '../../../../../../../common/widgets/collect_data_view.dart';
import '../../../../../../../common/widgets/textfields.dart';

class OrderCompanyInvoiceComponent extends StatelessWidget {
  const OrderCompanyInvoiceComponent({
    Key? key,
    required this.invoiceCompanyNameController,
    required this.invoiceCompanyTaxController,
    required this.invoiceCompanyAddressController,
    required this.onCompanyNameChanged,
    required this.onCompanyTaxChanged,
    required this.onCompanyAddressChanged,
    required this.errorFields,
    required this.errorIndexes,
    required this.scrollController,
  }) : super(key: key);

  final TextEditingController invoiceCompanyNameController;
  final TextEditingController invoiceCompanyTaxController;
  final TextEditingController invoiceCompanyAddressController;
  final Map<String, String> errorFields;
  final Map<String, int> errorIndexes;
  final AutoScrollController scrollController;
  final Function(String) onCompanyNameChanged;
  final Function(String) onCompanyTaxChanged;
  final Function(String) onCompanyAddressChanged;

  @override
  Widget build(BuildContext context) {
    return Column(
      children: [
        AutoScrollTag(
          controller: scrollController,
          key: ValueKey(errorIndexes[AppConstants.invoiceCompanyNameKey] ?? 0),
          index: errorIndexes[AppConstants.invoiceCompanyNameKey] ?? 0,
          child: CollectDataView(
            errorMsg: errorFields[AppConstants.invoiceCompanyNameKey],
            child: UITextField(
              controller: invoiceCompanyNameController,
              labelText: 'Tên công ty',
              hasError: errorFields[AppConstants.invoiceCompanyNameKey] != null,
              onChanged: onCompanyNameChanged,
            ),
          ),
        ),
        const SizedBox(
          height: 16,
        ),
        AutoScrollTag(
          controller: scrollController,
          key: ValueKey(errorIndexes[AppConstants.invoiceCompanyTaxKey] ?? 0),
          index: errorIndexes[AppConstants.invoiceCompanyTaxKey] ?? 0,
          child: CollectDataView(
            errorMsg: errorFields[AppConstants.invoiceCompanyTaxKey],
            child: UITextField(
              controller: invoiceCompanyTaxController,
              labelText: 'Mã số thuế công ty',
              hasError: errorFields[AppConstants.invoiceCompanyTaxKey] != null,
              onChanged: onCompanyTaxChanged,
              // inputFormatters: [
              //   FilteringTextInputFormatter.digitsOnly,
              // ],
            ),
          ),
        ),
        const SizedBox(
          height: 16,
        ),
        AutoScrollTag(
          controller: scrollController,
          key: ValueKey(errorIndexes[AppConstants.invoiceCompanyAddressKey] ?? 0),
          index: errorIndexes[AppConstants.invoiceCompanyAddressKey] ?? 0,
          child: CollectDataView(
            errorMsg: errorFields[AppConstants.invoiceCompanyAddressKey],
            child: UITextField(
              controller: invoiceCompanyAddressController,
              labelText: 'Địa chỉ công ty',
              hasError: errorFields[AppConstants.invoiceCompanyAddressKey] != null,
              onChanged: onCompanyAddressChanged,
            ),
          ),
        ),
      ],
    );
  }
}
