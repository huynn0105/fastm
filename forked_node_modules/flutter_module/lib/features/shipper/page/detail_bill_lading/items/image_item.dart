import 'package:auto_route/auto_route.dart';
import 'package:flutter/material.dart';
import 'package:flutter_bloc/flutter_bloc.dart';
import 'package:flutter_module/common/widgets/buttons.dart';
import 'package:flutter_module/features/shipper/cubit/upload_image/upload_image_cubit.dart';
import 'package:flutter_module/routes/routes.gr.dart';

import '../../../../../common/widgets/images.dart';

class ImageItem extends StatelessWidget {
  const ImageItem({
    super.key,
    required this.image,
    required this.editable,
    required this.onRemoveImage,
    this.onTap,
  });

  final String image;
  final bool editable;
  final Function() onRemoveImage;
  final Function()? onTap;

  @override
  Widget build(BuildContext context) {
    return AppSplashButton(
      onTap: () {
        if (onTap != null) {
          onTap?.call();
          return;
        }
        final result = context.read<UploadImageCubit>().convertPhotoPreview();
        context.pushRoute(ShipperPhotoPreviewRoute(photos: result, selectedPhoto: image));
      },
      child: Container(
        width: 108,
        height: 147,
        margin: const EdgeInsets.only(top: 4),
        child: Stack(
          children: [
            AppImage.network(
              url: image,
              width: 108,
              height: 143,
              borderRadius: BorderRadius.circular(8),
              cached: false,
            ),
            if (editable)
              Container(
                alignment: Alignment.topRight,
                transform: Matrix4.translationValues(6, -6, 0),
                child: SplashButton(
                  onTap: onRemoveImage,
                  child: const AppImage.asset(
                    asset: "ic_remove",
                    width: 28,
                    height: 28,
                  ),
                ),
              ),
          ],
        ),
      ),
    );
  }
}
