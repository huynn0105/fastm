import 'package:auto_route/annotations.dart';
import 'package:flutter/material.dart';
import 'package:flutter_bloc/flutter_bloc.dart';
import 'package:flutter_module/common/enum/income/history_income_type.dart';
import 'package:flutter_module/common/widgets/chart/donut_chart/donut_chart_controller.dart';
import 'package:flutter_module/features/account/cubit/statistic_income/statistic_income_cubit.dart';

import '../../../../../../common/constants.dart';
import 'components/regulation_component.dart';
import 'components/statistic_component.dart';

@RoutePage()
class StatisticIncomePage extends StatelessWidget {
  const StatisticIncomePage({
    Key? key,
    required this.chartController,
    required this.onHistoryTypeChanged,
  }) : super(key: key);

  final DonutChartController chartController;
  final Function(HistoryIncomeType type) onHistoryTypeChanged;

  @override
  Widget build(BuildContext context) {
    return BlocBuilder<StatisticIncomeCubit, StatisticIncomeState>(
      builder: (context, state) {
        final data = state.data;
        return ListView(
          physics: AppConstants.physics,
          padding: const EdgeInsets.fromLTRB(16, 0, 16, 100),
          children: [
            StatisticComponent(
              chartController: chartController,
              data: data,
              onHistoryTypeChanged: onHistoryTypeChanged,
            ),
            const SizedBox(
              height: 16,
            ),
            const RegulationComponent(),
          ],
        );
      },
    );
  }
}
