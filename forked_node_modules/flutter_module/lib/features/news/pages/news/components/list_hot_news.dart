import 'package:flutter/material.dart';
import 'package:flutter_module/common/colors.dart';
import 'package:flutter_module/common/constants.dart';
import 'package:flutter_module/common/styles.dart';
import 'package:flutter_module/common/utils/datetime_util.dart';
import 'package:flutter_module/common/widgets/images.dart';
import 'package:flutter_module/models/news/news_model.dart';

class ListHotNews extends StatelessWidget {
  const ListHotNews({
    super.key,
    required this.data,
  });

  final List<NewsModel> data;

  @override
  Widget build(BuildContext context) {
    NewsModel? firstNew;
    if (data.isNotEmpty == true) {
      firstNew = data.firstWhere((element) => true);
      data.removeAt(0);
    } else {
      return Container();
    }

    return Column(
      crossAxisAlignment: CrossAxisAlignment.start,
      children: [
        Text(
          'Tin tức nổi bật',
          style: UITextStyle.medium.copyWith(fontSize: 14, color: UIColors.lightBlack),
        ),
        const SizedBox(
          height: 12,
        ),
        Container(
          clipBehavior: Clip.hardEdge,
          decoration: BoxDecoration(borderRadius: BorderRadius.circular(12), color: UIColors.white),
          child: Column(
            children: [
              AspectRatio(
                aspectRatio: 343 / 192,
                child: AppImage.network(
                  url: firstNew.postImage ?? '',
                  width: double.infinity,
                  fit: BoxFit.fill,
                ),
              ),
              Padding(
                padding: const EdgeInsets.symmetric(horizontal: 16, vertical: 12),
                child: Column(
                  crossAxisAlignment: CrossAxisAlignment.start,
                  children: [
                    Text(
                      firstNew.postTitle ?? '',
                      style: UITextStyle.medium.copyWith(fontSize: 16),
                      maxLines: 2,
                      overflow: TextOverflow.ellipsis,
                    ),
                    const SizedBox(
                      height: 8,
                    ),
                    Row(
                      mainAxisAlignment: MainAxisAlignment.spaceBetween,
                      children: [
                        Text(
                          '# ${firstNew.hashtag ?? ''}',
                          style: UITextStyle.regular.copyWith(fontSize: 12, color: UIColors.grayText),
                        ),
                        Text(
                          '${DateTimeUtil.convertTimeAgo(
                            DateTime.fromMillisecondsSinceEpoch((firstNew.createdDate ?? 0) * 1000).toString(),
                            format: DateTimeFormat.yyyy_MM_dd_HH_mm_ss,
                          )} trước',
                          style: UITextStyle.regular.copyWith(fontSize: 12, color: UIColors.grayText),
                        )
                      ],
                    )
                  ],
                ),
              ),
            ],
          ),
        ),
        if (data.isNotEmpty == true) ...{
          const SizedBox(
            height: 16,
          ),
          SizedBox(
            height: 218,
            child: ListView.builder(
              physics: AppConstants.physics,
              itemCount: data.length,
              scrollDirection: Axis.horizontal,
              itemBuilder: (context, index) {
                var item = data[index];
                return Container(
                  width: 224,
                  margin: const EdgeInsets.only(right: 16),
                  clipBehavior: Clip.hardEdge,
                  decoration: BoxDecoration(borderRadius: BorderRadius.circular(12), color: UIColors.white),
                  child: Column(
                    mainAxisAlignment: MainAxisAlignment.start,
                    children: [
                      Image.network(item.postImage ?? '', width: 224, height: 125, fit: BoxFit.fill),
                      Padding(
                        padding: const EdgeInsets.symmetric(horizontal: 16, vertical: 12),
                        child: Column(
                          crossAxisAlignment: CrossAxisAlignment.start,
                          children: [
                            Text(
                              item.postTitle ?? '',
                              style: UITextStyle.medium.copyWith(fontSize: 14),
                              maxLines: 2,
                              overflow: TextOverflow.ellipsis,
                            ),
                            const SizedBox(
                              height: 8,
                            ),
                            Row(
                              mainAxisAlignment: MainAxisAlignment.spaceBetween,
                              children: [
                                Text(
                                  '# ${item.hashtag ?? ''}',
                                  style: UITextStyle.regular.copyWith(fontSize: 12, color: UIColors.grayText),
                                ),
                                Text(
                                  '${DateTimeUtil.convertTimeAgo(
                                    DateTime.fromMillisecondsSinceEpoch((item.createdDate ?? 0) * 1000).toString(),
                                    format: DateTimeFormat.yyyy_MM_dd_HH_mm_ss,
                                  )} trước',
                                  style: UITextStyle.regular.copyWith(fontSize: 12, color: UIColors.grayText),
                                )
                              ],
                            ),
                          ],
                        ),
                      ),
                    ],
                  ),
                );
              },
            ),
          ),
        },
        const SizedBox(
          height: 12,
        ),
      ],
    );
  }
}
