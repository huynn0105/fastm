import 'package:collection/collection.dart';
import 'package:flutter/material.dart';
import 'package:flutter_module/common/colors.dart';
import 'package:flutter_module/common/size.dart';
import 'package:flutter_module/common/styles.dart';
import 'package:flutter_module/features/chat/page/chat/children/contacts/components/list_contacts_component.dart';
import 'package:flutter_module/features/chat/page/search_contact/items/search_contact_item.dart';
import 'package:flutter_module/models/chat/contact/chat_contact_model.dart';
import 'package:flutter_sticky_header/flutter_sticky_header.dart';

class ListSearchContactsComponent extends StatelessWidget {
  const ListSearchContactsComponent({
    super.key,
    required this.data,
  });

  final List<ChatContactModel> data;

  @override
  Widget build(BuildContext context) {
    // List<Contact> listContacts = [];
    // for (int i = 0; i < 60; i++) {
    //   final text = getRandomString(50);
    //   listContacts.add(Contact(
    //       name: text,
    //       group: i < 20
    //           ? 'CONTACT'
    //           : i < 40
    //               ? 'FAVORITE'
    //               : 'RECENT'));
    // }
    // listContacts.sort(
    //   (a, b) => a.group!.compareTo(b.group!),
    // );

    // final groups = groupBy(listContacts, (e) => e.group ?? "");

    return Expanded(
        child: DefaultStickyHeaderController(
      child: Padding(
        padding: const EdgeInsets.symmetric(horizontal: 16),
        child: CustomScrollView(
          slivers: [
            SliverList(
              delegate: SliverChildBuilderDelegate(
                (context, index) {
                  final item = data[index];
                  return SearchContactItem(
                    item: item,
                    index: index,
                  );
                },
                childCount: data.length,
              ),
            ),
            // ...List.generate(
            //   groups.length,
            //   (index) {
            //     final key = groups.keys.toList()[index];
            //     final items = groups.values.toList()[index];
            //     return SliverStickyHeader.builder(
            //       builder: (context, state) {
            //         return AnimatedContainer(
            //           color: UIColors.background,
            //           padding: EdgeInsets.only(top: index > 0 && !state.isPinned ? 20 : 12, bottom: 8),
            //           duration: const Duration(milliseconds: 100),
            //           child: Row(
            //             children: [
            //               Text(
            //                 key == 'CONTACT'
            //                     ? 'Từ danh bạ'
            //                     : key == 'FAVORITE'
            //                         ? 'Ưu thích'
            //                         : 'Gần đây',
            //                 style: UITextStyle.regular.copyWith(
            //                   fontSize: 16,
            //                   color: UIColors.grayText,
            //                 ),
            //               )
            //             ],
            //           ),
            //         );
            //       },
            //       sliver: SliverToBoxAdapter(
            //         child: Container(
            //           padding: EdgeInsets.all(12),
            //           decoration: BoxDecoration(color: UIColors.white, borderRadius: BorderRadius.circular(8)),
            //           child: Column(
            //             mainAxisSize: MainAxisSize.min,
            //             children: List.generate(
            //               items.length,
            //               (index) {
            //                 final item = items[index];
            //                 return SearchContactItem(
            //                   item: item,
            //                   index: index,
            //                 );
            //               },
            //             ),
            //           ),
            //         ),
            //       ),
            //     );
            //   },
            // ),
            SliverPadding(padding: EdgeInsets.only(bottom: AppSize.instance.safeBottomBarHeight))
          ],
        ),
      ),
    ));
  }
}
