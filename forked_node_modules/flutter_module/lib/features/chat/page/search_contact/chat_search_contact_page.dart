import 'package:auto_route/auto_route.dart';
import 'package:flutter/material.dart';
import 'package:flutter_module/common/size.dart';
import 'package:flutter_module/common/widgets/empty_widget.dart';
import 'package:flutter_module/features/chat/page/chat/components/chat_search_bar_component.dart';
import 'package:flutter_module/features/chat/page/search_contact/components/list_search_contacts_component.dart';
import 'package:flutter_module/models/chat/contact/chat_contact_model.dart';

@RoutePage()
class ChatSearchContactPage extends StatefulWidget {
  const ChatSearchContactPage({
    super.key,
    required this.contacts,
  });

  final List<ChatContactModel> contacts;

  @override
  State<ChatSearchContactPage> createState() => _ChatSearchContactPageState();
}

class _ChatSearchContactPageState extends State<ChatSearchContactPage> {
  String textSearch = '';

  @override
  Widget build(BuildContext context) {
    final data = widget.contacts
        .where((element) => element.fullName?.toLowerCase().contains(textSearch.toLowerCase()) ?? false)
        .toList();

    return Scaffold(
      body: Column(
        children: [
          SizedBox(
            height: AppSize.instance.safeTop,
          ),
          const SizedBox(
            height: 4,
          ),
          ChatSearchBarComponent(
            autoFocus: true,
            showButtonClose: true,
            onChanged: (p0) {
              setState(() {
                textSearch = p0;
              });
            },
          ),
          if (data.isEmpty) ...{
            const SizedBox(
              height: 32,
            ),
            const EmptyWidget(message: "Không tìm thấy liên hệ"),
          } else ...{
            const SizedBox(
              height: 16,
            ),
            ListSearchContactsComponent(data: data),
          }
        ],
      ),
    );
  }
}
