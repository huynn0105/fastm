import 'package:flutter/material.dart';
import 'package:flutter_module/common/colors.dart';
import 'package:flutter_module/common/styles.dart';
import 'package:flutter_module/common/utils/datetime_util.dart';
import 'package:flutter_module/common/widgets/buttons.dart';
import 'package:flutter_module/common/widgets/images.dart';
import 'package:flutter_module/models/client/client_detail/client_document_model.dart';

class AttachmentImageItem extends StatelessWidget {
  const AttachmentImageItem({
    super.key,
    required this.item,
    this.onTapImage,
  });

  final ClientDocumentModel item;
  final Function(String image)? onTapImage;

  @override
  Widget build(BuildContext context) {
    final length = item.image?.length ?? 0;
    return Column(
      crossAxisAlignment: CrossAxisAlignment.start,
      children: [
        const SizedBox(
          height: 16,
        ),
        Text(
          DateTimeUtil.getNumberDayBetween(
            item.date ?? '',
            forceShowDateFormat: (duration) {
              if (duration.inDays > 3) {
                return DateTimeFormat.ddMMyyyy;
              }
              return null;
            },
          ),
          style: UITextStyle.regular,
        ),
        const SizedBox(
          height: 12,
        ),
        GridView.count(
          physics: const NeverScrollableScrollPhysics(),
          shrinkWrap: true,
          crossAxisCount: length > 1 ? 2 : 1,
          mainAxisSpacing: 8,
          crossAxisSpacing: 8,
          childAspectRatio: 168 / 112,
          padding: EdgeInsets.zero,
          children: [
            ...List.generate(
              item.image?.length ?? 0,
              (index) {
                final image = item.image![index];
                return SplashButton(
                  onTap: () {
                    onTapImage?.call(image);
                  },
                  child: Container(
                    clipBehavior: Clip.hardEdge,
                    width: double.infinity,
                    height: double.infinity,
                    decoration: BoxDecoration(
                      color: UIColors.white,
                      borderRadius: BorderRadius.circular(8),
                    ),
                    child: AppImage.network(url: image),
                  ),
                );
              },
            ),
          ],
        ),
        const SizedBox(
          height: 8,
        ),
      ],
    );
  }
}
