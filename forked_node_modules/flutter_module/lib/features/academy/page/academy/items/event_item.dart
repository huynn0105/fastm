import 'package:auto_route/auto_route.dart';
import 'package:flutter/material.dart';
import 'package:flutter_module/common/colors.dart';
import 'package:flutter_module/common/styles.dart';
import 'package:flutter_module/common/widgets/buttons.dart';
import 'package:flutter_module/common/widgets/images.dart';
import 'package:flutter_module/features/academy/page/academy/inheritance/academy_action_provider.dart';
import 'package:flutter_module/models/academy/event/academy_event_model.dart';
import 'package:flutter_module/routes/routes.gr.dart';

class EventItem extends StatelessWidget {
  const EventItem({
    required this.item,
    this.index,
    super.key,
  });

  final AcademyEventModel item;
  final int? index;

  @override
  Widget build(BuildContext context) {
    final disabled = (item.eventInvalid ?? false);
    return IgnorePointer(
      ignoring: disabled,
      child: SplashButton(
        onTap: () {
          context.pushRoute(AcademyEventDetailRoute(eventID: item.eventID ?? '')).then((value) {
            if (value is bool && value == true) {
              AcademyActionProvider.of(context).onRefresh(context);
            }
          });
        },
        child: Container(
          width: double.infinity,
          clipBehavior: Clip.hardEdge,
          decoration: BoxDecoration(
            borderRadius: BorderRadius.circular(8),
            color: UIColors.white,
          ),
          margin: const EdgeInsets.only(top: 16),
          child: Column(
            crossAxisAlignment: CrossAxisAlignment.start,
            children: [
              AspectRatio(
                aspectRatio: 343 / 190,
                child: AppImage.network(
                  url: item.banner,
                  width: double.infinity,
                ),
              ),
              const SizedBox(
                height: 12,
              ),
              Padding(
                padding: const EdgeInsets.symmetric(horizontal: 12),
                child: Column(
                  crossAxisAlignment: CrossAxisAlignment.start,
                  children: [
                    Text(
                      item.eventName ?? '',
                      style: UITextStyle.semiBold.copyWith(fontSize: 16),
                    ),
                    const SizedBox(
                      height: 6,
                    ),
                    Row(
                      crossAxisAlignment: CrossAxisAlignment.start,
                      children: [
                        const AppImage.asset(
                          asset: 'ic_time_outline',
                          width: 20,
                          height: 20,
                          color: UIColors.grayText,
                        ),
                        const SizedBox(
                          width: 6,
                        ),
                        Expanded(
                          child: Text(
                            '${item.timeLine}  | Thời lượng: ${item.duration ?? ''}',
                            style: UITextStyle.regular.copyWith(
                              fontSize: 13,
                              color: UIColors.grayText,
                            ),
                          ),
                        ),
                      ],
                    ),
                    const SizedBox(
                      height: 8,
                    ),
                    Row(
                      crossAxisAlignment: CrossAxisAlignment.start,
                      children: [
                        const AppImage.asset(
                          asset: 'ic_location_outline',
                          width: 20,
                          height: 20,
                          color: UIColors.grayText,
                        ),
                        const SizedBox(
                          width: 6,
                        ),
                        Expanded(
                          child: Text(
                            item.location ?? '',
                            style: UITextStyle.regular.copyWith(
                              fontSize: 13,
                              color: UIColors.grayText,
                            ),
                          ),
                        ),
                      ],
                    ),
                    const SizedBox(
                      height: 8,
                    ),
                    Row(
                      crossAxisAlignment: CrossAxisAlignment.start,
                      children: [
                        const AppImage.asset(
                          asset: 'ic_user_outline',
                          width: 20,
                          height: 20,
                          color: UIColors.grayText,
                        ),
                        const SizedBox(
                          width: 6,
                        ),
                        Expanded(
                          child: Text(
                            '${item.participantAmount} người',
                            style: UITextStyle.regular.copyWith(
                              fontSize: 13,
                              color: UIColors.grayText,
                            ),
                          ),
                        ),
                        Row(
                          children: [
                            Text(
                              item.eventInvalid == true
                                  ? item.invalidMessage ?? ''
                                  : item.checkout == true
                                      ? "Đã check out"
                                      : item.checkin == true
                                          ? "Đã check in"
                                          : item.register == true
                                              ? "Đã đăng ký"
                                              : 'Còn ${item.validAmount} chỗ',
                              style: UITextStyle.semiBold.copyWith(
                                color: item.eventInvalid! ? UIColors.red : UIColors.green,
                              ),
                              textAlign: TextAlign.right,
                            ),
                            if (item.checkout == true || item.checkin == true || item.register == true) ...[
                              SizedBox(
                                width: 4,
                              ),
                              AppImage.asset(
                                asset: "ic_success",
                                width: 16,
                                height: 16,
                              )
                            ],
                          ],
                        ),
                      ],
                    ),
                    const SizedBox(
                      height: 8,
                    ),
                    if (!item.eventInvalid!) ...[
                      Center(
                        child: SplashButton(
                          child: Text(
                            'CHI TIẾT SỰ KIỆN >>',
                            style: UITextStyle.semiBold.copyWith(
                              color: UIColors.primaryColor,
                            ),
                          ),
                        ),
                      ),
                      const SizedBox(
                        height: 10,
                      ),
                    ],
                    const SizedBox(
                      height: 6,
                    ),
                  ],
                ),
              ),
            ],
          ),
        ),
      ),
    );
  }
}
