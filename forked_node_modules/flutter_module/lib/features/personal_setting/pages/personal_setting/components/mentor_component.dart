import 'package:auto_route/auto_route.dart';
import 'package:flutter/material.dart';
import 'package:flutter_bloc/flutter_bloc.dart';
import 'package:flutter_module/common/size.dart';
import 'package:flutter_module/routes/routes.gr.dart';

import '../../../../../common/bottom_sheet/bottom_sheet_provider.dart';
import '../../../../../common/colors.dart';
import '../../../../../common/styles.dart';
import '../../../../../common/widgets/buttons.dart';
import '../../../../../common/widgets/images.dart';
import '../../../cubit/mentor_rating/mentor_rating_cubit.dart';
import 'mentor_rating_component.dart';
import 'mentor_review_component.dart';

class MentorComponent extends StatelessWidget {
  const MentorComponent({
    Key? key,
    required this.name,
    required this.rank,
    required this.url,
  }) : super(key: key);

  final String name;
  final String rank;
  final String url;

  @override
  Widget build(BuildContext context) {
    return LimitedBox(
      maxHeight: AppSize.instance.height * 0.75,
      child: SingleChildScrollView(
        child: Padding(
          padding: const EdgeInsets.all(16),
          child: Column(
            mainAxisSize: MainAxisSize.min,
            children: [
              Row(
                crossAxisAlignment: CrossAxisAlignment.start,
                children: [
                  AppImage.network(
                    url: url,
                    width: 64,
                    height: 64,
                    borderRadius: BorderRadius.circular(50),
                  ),
                  const SizedBox(
                    width: 16,
                  ),
                  Expanded(
                    child: Column(
                      children: [
                        Row(
                          children: [
                            Expanded(
                              child: Column(
                                crossAxisAlignment: CrossAxisAlignment.start,
                                mainAxisAlignment: MainAxisAlignment.center,
                                children: [
                                  Text(
                                    name,
                                    style: UITextStyle.semiBold.copyWith(
                                      fontSize: 18,
                                    ),
                                    maxLines: 1,
                                    overflow: TextOverflow.ellipsis,
                                  ),
                                  Text(
                                    rank,
                                    style: UITextStyle.semiBold.copyWith(
                                      fontSize: 14,
                                      color: UIColors.darkBlue,
                                    ),
                                    maxLines: 1,
                                    overflow: TextOverflow.ellipsis,
                                  ),
                                ],
                              ),
                            ),
                            SplashButton(
                              onTap: () {},
                              child: const AppImage.asset(
                                asset: "ic_chat",
                                width: 24,
                                height: 24,
                                color: UIColors.primaryColor,
                              ),
                            ),
                            const SizedBox(
                              width: 20,
                            ),
                            SplashButton(
                              onTap: () {},
                              child: const AppImage.asset(
                                asset: "ic_call",
                                width: 24,
                                height: 24,
                                color: UIColors.primaryColor,
                              ),
                            ),
                          ],
                        ),
                        Text(
                          "“Đừng ngại tương tác khi cần hỗ trợ nhé, mình ở đây là để đi cùng bạn.”",
                          style: UITextStyle.regular.copyWith(
                            fontStyle: FontStyle.italic,
                            color: UIColors.grayText,
                          ),
                        ),
                      ],
                    ),
                  ),
                ],
              ),
              const SizedBox(
                height: 12,
              ),
              Container(
                padding: const EdgeInsets.symmetric(
                  vertical: 10,
                  horizontal: 16,
                ),
                decoration: BoxDecoration(
                  color: UIColors.white,
                  borderRadius: BorderRadius.circular(8),
                ),
                child: Row(
                  mainAxisAlignment: MainAxisAlignment.spaceBetween,
                  children: [
                    SplashButton(
                      onTap: () {
                        Navigator.of(context).pop();
                        BottomSheetProvider.instance.show(
                          context,
                          title:
                              "Bạn đánh giá sao về chất lượng dẫn dắt của $name ?",
                          child: BlocProvider.value(
                            value: context.read<MentorRatingCubit>(),
                            child: MentorReviewComponent(
                              name: name,
                              url: url,
                            ),
                          ),
                        );
                      },
                      child: Row(
                        mainAxisSize: MainAxisSize.min,
                        children: [
                          const AppImage.asset(
                            asset: "ic_like",
                            width: 20,
                            height: 20,
                          ),
                          const SizedBox(
                            width: 4,
                          ),
                          Text(
                            "Đánh giá",
                            style: UITextStyle.regular.copyWith(
                              color: UIColors.primaryColor,
                            ),
                          )
                        ],
                      ),
                    ),
                    SplashButton(
                      onTap: () {
                        context.pushRoute(const RegisterMentorRoute());
                      },
                      child: Row(
                        mainAxisSize: MainAxisSize.min,
                        children: [
                          Text(
                            "Đổi người dẫn dắt",
                            style: UITextStyle.regular.copyWith(
                              color: UIColors.primaryColor,
                            ),
                          ),
                          const SizedBox(
                            width: 4,
                          ),
                          const AppImage.asset(
                            asset: "ic_edit",
                            width: 20,
                            height: 20,
                          ),
                        ],
                      ),
                    ),
                  ],
                ),
              ),
              const SizedBox(
                height: 16,
              ),
              MentorRatingComponent(
                name: name,
              ),
            ],
          ),
        ),
      ),
    );
  }
}
