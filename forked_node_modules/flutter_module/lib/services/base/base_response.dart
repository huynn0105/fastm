import 'dart:convert';

class BaseResponse {
  final bool? status;
  final String? socketEventType;
  final String? initByStep;
  final int? socketChunkLength;
  final int? socketChunkIndex;
  final String? errorTitle;
  final String? errorMessage;
  final String? errorCode;
  final String? uuid;
  final dynamic data;
  final dynamic raw;

  BaseResponse({
    this.status,
    this.errorTitle,
    this.errorMessage,
    this.socketEventType,
    this.initByStep,
    this.socketChunkLength,
    this.socketChunkIndex,
    this.errorCode,
    this.uuid,
    this.data,
    this.raw,
  });

  factory BaseResponse.fromJsonSuccess(Map<String, dynamic> json) {
    return BaseResponse(
      status: true,
      data: json["data"] ?? json,
      errorCode: json["errorCode"] ?? json["error_code"],
      errorTitle: json["title"],
      errorMessage: json["message"] ?? json["error"],
      raw: json,
    );
  }

  factory BaseResponse.fromJsonFail(Map<String, dynamic> json) {
    String? errorMessage;
    try {
      if (json["message"] is List) {
        errorMessage = (json["message"] as List).join('\n\n');
      } else {
        errorMessage = (json["message"] ??
            json["error"] ??
            json["err_msg"] ??
            (json["data"] is Map ? (json["data"]?["err_msg"]) : null)) as String?;
      }
    } catch (_) {}

    String? errorCode;
    try {
      errorCode = json["errorCode"] ??
          json["error_code"] ??
          json["err_code"] ??
          json["err_code "] ??
          (json["data"] is Map ? (json["data"]?["err_code"]) : null) as String?;
    } catch (_) {}

    return BaseResponse(
      status: false,
      errorTitle: json["title"] as String?,
      errorMessage: errorMessage,
      errorCode: errorCode,
      data: json["data"] ?? json,
      raw: json,
    );
  }
}
