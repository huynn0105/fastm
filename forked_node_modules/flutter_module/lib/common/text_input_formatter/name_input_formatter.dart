import 'package:flutter/services.dart';

class NameInputFormatter extends TextInputFormatter {
  @override
  TextEditingValue formatEditUpdate(
      TextEditingValue oldValue, TextEditingValue newValue) {
    final reg = RegExp(
        r"[^a-zA-Z0-9 _ÀÁÂÃÈÉÊÌÍÒÓÔÕÙÚĂĐĨŨƠàáâãèéêìíòóôõùúăđĩũơƯĂẠẢẤẦẨẪẬẮẰẲẴẶẸẺẼỀỀỂưăạảấầẩẫậắằẳẵặẹẻẽềềểỄỆỈỊỌỎỐỒỔỖỘỚỜỞỠỢỤỦỨỪễếệỉịọỏốồổỗộớờởỡợụủứừỬỮỰỲỴÝỶỸửữựỳỵỷỹ]");
    var text = newValue.text.replaceAll(reg, '');
    int offset = 0;
    if (newValue.selection.baseOffset < text.length) {
      if (text.length == newValue.text.length) {
        offset = newValue.selection.baseOffset;
      } else {
        offset = newValue.selection.baseOffset - 1;
      }
    } else {
      offset = text.length;
    }
    return TextEditingValue(
      text: text,
      selection: TextSelection.collapsed(
        offset: offset,
      ),
    );
  }
}
