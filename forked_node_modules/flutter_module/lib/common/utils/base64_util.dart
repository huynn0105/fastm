import 'dart:convert';
import 'dart:io';
import 'dart:typed_data';

import 'package:path_provider/path_provider.dart';

class Base64Util {
  Base64Util._();

  static String formatBase64(String? imgBase64) {
    if (imgBase64 == null) return '';
    return imgBase64.replaceAll(RegExp(r'^data:image\/[a-z]+;base64,'), '');
  }

  static Future<File?> convertBase64ToFile(String imageBase64) async {
    try {
      final Uint8List bytes = base64Decode(imageBase64);
      final directory = await getApplicationDocumentsDirectory();
      final fileName = '${DateTime.now().millisecondsSinceEpoch}.jpg';

      final filePath = '${directory.path}/$fileName';
      final file = File(filePath);
      file.writeAsBytesSync(bytes);

      return file;
    } catch (error) {
      return null;
    }
  }
}
