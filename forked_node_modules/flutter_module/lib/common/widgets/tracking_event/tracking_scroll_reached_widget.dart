import 'package:flutter/material.dart';

class TrackingScrollReachedWidget extends StatelessWidget {
  const TrackingScrollReachedWidget({
    Key? key,
    required this.child,
    this.onReachedTop,
    this.onReachedBottom,
    this.onCanLoadMore,
  }) : super(key: key);

  final Widget child;
  final Function()? onReachedTop;
  final Function()? onReachedBottom;
  final bool Function()? onCanLoadMore;

  @override
  Widget build(BuildContext context) {
    return NotificationListener<ScrollEndNotification>(
      onNotification: (detail) {
        final isReachedBottom = detail.metrics.pixels > 0 && detail.metrics.atEdge;
        final isReachedTop = detail.metrics.pixels <= 0 && detail.metrics.atEdge;
        final canLoadMore = (onCanLoadMore?.call() == true);
        if (isReachedBottom && onReachedBottom != null && !canLoadMore) {
          onReachedBottom!();
        }
        if (isReachedTop && onReachedTop != null) {
          onReachedTop!();
        }
        return true;
      },
      child: child,
    );
  }
}
