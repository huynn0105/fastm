import 'package:flutter_module/models/mtrade/order/order_history_model.dart';
import 'package:flutter_module/models/mtrade/order/order_model.dart';
import 'package:flutter_module/services/api/mtrade/payload/mtrade_pay_now_order_payload.dart';

class MTradeOrderDetailModel extends OrderModel {
  MTradeOrderDetailModel({
    super.itemIDs,
    super.id,
    super.orderID,
    super.amountAfterTax,
    super.createdDate,
    super.paymentID,
    super.updatedDate,
    super.status,
    super.processID,
    super.processText,
    super.note,
    super.appID,
    super.mplToken,
    super.icon,
    super.fullName,
    super.mobilePhone,
    super.sumBonus,
    super.items,
    super.trackingPartner,
    super.urlDetail,
    super.paymentMethod,
    super.prepayAmount,
    super.loanAmount,
    super.pendingStateOrder,
    super.conversationFeeAmount,
    this.customerInfo,
    this.history,
    this.processState,
  });

  MTradeOrderDetailModel.fromJson(dynamic json) : super.fromJson(json) {
    customerInfo = json['customerInfo'] != null
        ? CustomerInfo.fromJson(json['customerInfo'])
        : null;
    fullName = customerInfo?.name;
    mobilePhone = customerInfo?.phone;
    if (json['history'] != null) {
      history = [];
      json['history'].forEach((v) {
        history?.add(OrderHistoryModel.fromJson(v));
      });
    }
    processState = json['process_state'];
  }

  CustomerInfo? customerInfo;
  List<OrderHistoryModel>? history;
  String? processState;

  @override
  Map<String, dynamic> toJson() {
    final map = <String, dynamic>{};

    map.addAll(super.toJson());
    if (customerInfo != null) {
      map['customerInfo'] = CustomerInfo().toJsonOrderProcessState();
      map['history'] = OrderHistoryModel().toJson();
      map['process_state'] = processState;
    }

    return map;
  }
}
