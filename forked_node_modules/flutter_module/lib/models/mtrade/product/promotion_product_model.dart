import 'package:flutter_module/common/enum/mtrade/promotion_discount_type.dart';
import 'package:flutter_module/common/utils/format_util.dart';
import 'package:flutter_module/common/utils/text_util.dart';
import 'package:image/image.dart';

/// promotion_value : "1000"
/// promotion_price : "1000"
/// oms_promotion_condition : {"oms_promotion":{"code":"00049","name":"test chơi","time_end":"2023-08-14T14:00:00+00:00","time_start":"2023-07-14T00:00:00+00:00","order_quantity":"100","order_quantity_available":"100","description":"<p>aaaaaAaaaaa</p>\n","master_object_type":{"code":"STAFF","name":"Nhân viên"}},"master_collect_transaction_type":{"code":"VND","name":"VNĐ"},"master_promotion_apply_type":{"code":"APPLY_TO_ALL_PRODUCT","name":"Áp dụng cùng mức giảm"},"master_promotion_category":{"code":"PRODUCT","name":"PRODUCT"},"master_promotion_gif_category":{"code":"PROMOTION_PRICE","name":"Giảm giá"}}

class PromotionProductModel {
  PromotionProductModel({
    this.promotionValue,
    this.promotionPrice,
    this.omsPromotionCondition,
  });

  PromotionProductModel.fromJson(dynamic json) {
    promotionValue = TextUtils.parseDouble(json['promotion_value']);
    promotionPrice = TextUtils.parseDouble(json['promotion_price']);
    omsPromotionCondition = json['oms_promotion_condition'] != null
        ? OmsPromotionCondition.fromJson(json['oms_promotion_condition'])
        : null;
  }

  double? promotionValue;
  double? promotionPrice;
  OmsPromotionCondition? omsPromotionCondition;

  Map<String, dynamic> toJson() {
    final map = <String, dynamic>{};
    map['promotion_value'] = promotionValue;
    map['promotion_price'] = promotionPrice;
    if (omsPromotionCondition != null) {
      map['oms_promotion_condition'] = omsPromotionCondition?.toJson();
    }
    return map;
  }

  double getPromotionDiscount(double price) {
    final promotionPrice = this.promotionPrice ?? 0;
    final promotionValue = this.promotionValue ?? 0;
    if (omsPromotionCondition?.masterCollectTransactionType?.code == PromotionDiscountType.vnd.code) {
      return promotionPrice;
    }
    return price * (1 - promotionValue).ceil();
  }

  String getPromotionUnitCurrency() {
    String result = "";
    final promotionPrice = this.promotionPrice ?? 0;
    final promotionValue = this.promotionValue ?? 0;
    if (omsPromotionCondition?.masterCollectTransactionType?.code == PromotionDiscountType.vnd.code) {
      result = FormatUtil.numberFormat(promotionPrice);
    } else {
      result = "${promotionValue.toInt()}%";
    }
    return result;
  }
}

/// oms_promotion : {"code":"00049","name":"test chơi","time_end":"2023-08-14T14:00:00+00:00","time_start":"2023-07-14T00:00:00+00:00","order_quantity":"100","order_quantity_available":"100","description":"<p>aaaaaAaaaaa</p>\n","master_object_type":{"code":"STAFF","name":"Nhân viên"}}
/// master_collect_transaction_type : {"code":"VND","name":"VNĐ"}
/// master_promotion_apply_type : {"code":"APPLY_TO_ALL_PRODUCT","name":"Áp dụng cùng mức giảm"}
/// master_promotion_category : {"code":"PRODUCT","name":"PRODUCT"}
/// master_promotion_gif_category : {"code":"PROMOTION_PRICE","name":"Giảm giá"}

class OmsPromotionCondition {
  OmsPromotionCondition({
    this.omsPromotion,
    this.masterCollectTransactionType,
    this.masterPromotionApplyType,
    this.masterPromotionCategory,
    this.masterPromotionGifCategory,
  });

  OmsPromotionCondition.fromJson(dynamic json) {
    omsPromotion = json['oms_promotion'] != null ? OmsPromotion.fromJson(json['oms_promotion']) : null;
    masterCollectTransactionType = json['master_collect_transaction_type'] != null
        ? MasterCollectTransactionType.fromJson(json['master_collect_transaction_type'])
        : null;
    masterPromotionApplyType = json['master_promotion_apply_type'] != null
        ? MasterPromotionApplyType.fromJson(json['master_promotion_apply_type'])
        : null;
    masterPromotionCategory = json['master_promotion_category'] != null
        ? MasterPromotionCategory.fromJson(json['master_promotion_category'])
        : null;
    masterPromotionGifCategory = json['master_promotion_gif_category'] != null
        ? MasterPromotionGifCategory.fromJson(json['master_promotion_gif_category'])
        : null;
  }

  OmsPromotion? omsPromotion;
  MasterCollectTransactionType? masterCollectTransactionType;
  MasterPromotionApplyType? masterPromotionApplyType;
  MasterPromotionCategory? masterPromotionCategory;
  MasterPromotionGifCategory? masterPromotionGifCategory;

  Map<String, dynamic> toJson() {
    final map = <String, dynamic>{};
    if (omsPromotion != null) {
      map['oms_promotion'] = omsPromotion?.toJson();
    }
    if (masterCollectTransactionType != null) {
      map['master_collect_transaction_type'] = masterCollectTransactionType?.toJson();
    }
    if (masterPromotionApplyType != null) {
      map['master_promotion_apply_type'] = masterPromotionApplyType?.toJson();
    }
    if (masterPromotionCategory != null) {
      map['master_promotion_category'] = masterPromotionCategory?.toJson();
    }
    if (masterPromotionGifCategory != null) {
      map['master_promotion_gif_category'] = masterPromotionGifCategory?.toJson();
    }
    return map;
  }
}

/// code : "PROMOTION_PRICE"
/// name : "Giảm giá"

class MasterPromotionGifCategory {
  MasterPromotionGifCategory({
    this.code,
    this.name,
  });

  MasterPromotionGifCategory.fromJson(dynamic json) {
    code = json['code'];
    name = json['name'];
  }

  String? code;
  String? name;

  MasterPromotionGifCategory copyWith({
    String? code,
    String? name,
  }) =>
      MasterPromotionGifCategory(
        code: code ?? this.code,
        name: name ?? this.name,
      );

  Map<String, dynamic> toJson() {
    final map = <String, dynamic>{};
    map['code'] = code;
    map['name'] = name;
    return map;
  }
}

/// code : "PRODUCT"
/// name : "PRODUCT"

class MasterPromotionCategory {
  MasterPromotionCategory({
    this.code,
    this.name,
  });

  MasterPromotionCategory.fromJson(dynamic json) {
    code = json['code'];
    name = json['name'];
  }

  String? code;
  String? name;

  Map<String, dynamic> toJson() {
    final map = <String, dynamic>{};
    map['code'] = code;
    map['name'] = name;
    return map;
  }
}

/// code : "APPLY_TO_ALL_PRODUCT"
/// name : "Áp dụng cùng mức giảm"

class MasterPromotionApplyType {
  MasterPromotionApplyType({
    this.code,
    this.name,
  });

  MasterPromotionApplyType.fromJson(dynamic json) {
    code = json['code'];
    name = json['name'];
  }

  String? code;
  String? name;

  Map<String, dynamic> toJson() {
    final map = <String, dynamic>{};
    map['code'] = code;
    map['name'] = name;
    return map;
  }
}

/// code : "VND"
/// name : "VNĐ"

class MasterCollectTransactionType {
  MasterCollectTransactionType({
    this.code,
    this.name,
  });

  MasterCollectTransactionType.fromJson(dynamic json) {
    code = json['code'];
    name = json['name'];
  }

  String? code;
  String? name;

  Map<String, dynamic> toJson() {
    final map = <String, dynamic>{};
    map['code'] = code;
    map['name'] = name;
    return map;
  }
}

/// code : "00049"
/// name : "test chơi"
/// time_end : "2023-08-14T14:00:00+00:00"
/// time_start : "2023-07-14T00:00:00+00:00"
/// order_quantity : "100"
/// order_quantity_available : "100"
/// description : "<p>aaaaaAaaaaa</p>\n"
/// master_object_type : {"code":"STAFF","name":"Nhân viên"}

class OmsPromotion {
  OmsPromotion({
    this.code,
    this.name,
    this.timeEnd,
    this.timeStart,
    this.orderQuantity,
    this.orderQuantityAvailable,
    this.description,
    this.masterObjectType,
  });

  OmsPromotion.fromJson(dynamic json) {
    code = json['code'];
    name = json['name'];
    timeEnd = json['time_end'];
    timeStart = json['time_start'];
    orderQuantity = TextUtils.parseInt(json['order_quantity']);
    orderQuantityAvailable = TextUtils.parseInt(json['order_quantity_available']);
    description = json['description'];
    masterObjectType =
        json['master_object_type'] != null ? MasterObjectType.fromJson(json['master_object_type']) : null;
  }

  String? code;
  String? name;
  String? timeEnd;
  String? timeStart;
  int? orderQuantity;
  int? orderQuantityAvailable;
  String? description;
  MasterObjectType? masterObjectType;

  Map<String, dynamic> toJson() {
    final map = <String, dynamic>{};
    map['code'] = code;
    map['name'] = name;
    map['time_end'] = timeEnd;
    map['time_start'] = timeStart;
    map['order_quantity'] = orderQuantity;
    map['order_quantity_available'] = orderQuantityAvailable;
    map['description'] = description;
    if (masterObjectType != null) {
      map['master_object_type'] = masterObjectType?.toJson();
    }
    return map;
  }
}

/// code : "STAFF"
/// name : "Nhân viên"

class MasterObjectType {
  MasterObjectType({
    this.code,
    this.name,
  });

  MasterObjectType.fromJson(dynamic json) {
    code = json['code'];
    name = json['name'];
  }

  String? code;
  String? name;

  Map<String, dynamic> toJson() {
    final map = <String, dynamic>{};
    map['code'] = code;
    map['name'] = name;
    return map;
  }
}
